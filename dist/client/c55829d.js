(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{461:function(t,e,n){var content=n(465);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(8).default)("42bfc524",content,!0,{sourceMap:!1})},462:function(t,e,n){"use strict";n.r(e);var r=n(1),o=n(80),c=n(473),l=n.n(c);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var f={name:"FloatButtonGroup",components:{SearchTool:n(156).default},props:{appUrl:{type:String,default:"应用下载地址"},shareUrl:{type:String,default:void 0},search:{type:Boolean,default:!1}},data:function(){return{fab:!1,appQR:"",fabShare:!1,shareQR:""}},computed:v(v({},Object(o.b)(["footer","content"])),{},{right:function(){var t=this.content.left+this.content.width+90,e=document.documentElement.clientWidth-t;return e>0?e:0}}),watch:{appUrl:function(t){this.calcAppQR()},shareUrl:function(t){this.calcShareQR()}},created:function(){},mounted:function(){this.calcAppQR(),this.calcShareQR()},methods:{calcAppQR:function(){var t=this;this.appUrl&&l.a.toDataURL(this.appUrl).then((function(e){t.appQR=e})).catch((function(t){console.error(t)}))},calcShareQR:function(){var t=this;this.shareUrl&&l.a.toDataURL(this.shareUrl).then((function(e){t.shareQR=e})).catch((function(t){console.error(t)}))}}},h=(n(464),n(22)),m=n(38),_=n.n(m),x=n(186),k=n(456),y=n(187),S=n(184),C=n(459),O=n(42),w=n(485),component=Object(h.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:{right:t.right+"px",bottom:"100px"},attrs:{id:"group"}},[t._t("prepend"),t._v(" "),t.shareUrl?n("div",[n("v-speed-dial",{attrs:{direction:"left","open-on-hover":""},scopedSlots:t._u([{key:"activator",fn:function(){return[n("v-btn",{attrs:{fab:"",dark:"",large:"",color:"blue darken-2"},model:{value:t.fabShare,callback:function(e){t.fabShare=e},expression:"fabShare"}},[n("v-icon",{attrs:{dark:""}},[t._v("\n            mdi-share-variant\n          ")])],1)]},proxy:!0}],null,!1,2522381705),model:{value:t.fabShare,callback:function(e){t.fabShare=e},expression:"fabShare"}},[t._v(" "),n("v-card",[n("v-avatar",{attrs:{size:"150",tile:"",color:"grey"}},[n("img",{attrs:{alt:"分享",src:t.shareQR}})])],1)],1)],1):t._e(),t._v(" "),n("div",[n("v-speed-dial",{attrs:{direction:"left","open-on-hover":""},scopedSlots:t._u([{key:"activator",fn:function(){return[n("v-btn",{attrs:{fab:"",dark:"",large:"",color:"blue darken-2"},model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[n("v-icon",{attrs:{dark:""}},[t._v("\n            mdi-cellphone-android\n          ")])],1)]},proxy:!0}]),model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[t._v(" "),n("v-card",[n("v-avatar",{attrs:{size:"150",tile:"",color:"grey"}},[n("img",{attrs:{alt:"APP 下载",src:t.appQR}})])],1)],1)],1),t._v(" "),t.search?n("div",[n("v-menu",{attrs:{"offset-x":"",transition:"slide-x-transition","nudge-left":"8",left:"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-btn",t._g(t._b({attrs:{fab:"",dark:"",large:"",color:"blue darken-2"}},"v-btn",o,!1),r),[n("v-icon",{attrs:{dark:""}},[t._v("\n            mdi-magnify\n          ")])],1)]}}],null,!1,1942183284)},[t._v(" "),n("v-sheet",{attrs:{elevation:"1",width:"300"}},[n("search-tool",{attrs:{small:"",height:30}})],1)],1)],1):t._e(),t._v(" "),n("div",[n("v-btn",{attrs:{fab:"",dark:"",large:"",color:"purple"},on:{click:function(e){return t.$vuetify.goTo(0,{duration:300})}}},[n("v-icon",{attrs:{dark:""}},[t._v("\n        mdi-chevron-up\n      ")])],1)],1),t._v(" "),t._t("append")],2)}),[],!1,null,"8d061670",null);e.default=component.exports;_()(component,{SearchTool:n(156).default}),_()(component,{VAvatar:x.a,VBtn:k.a,VCard:y.a,VIcon:S.a,VMenu:C.a,VSheet:O.a,VSpeedDial:w.a})},463:function(t,e,n){var content=n(469);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(8).default)("566bab80",content,!0,{sourceMap:!1})},464:function(t,e,n){"use strict";n(461)},465:function(t,e,n){var r=n(7)(!1);r.push([t.i,"#group[data-v-8d061670]{position:fixed;z-index:10}#group div[data-v-8d061670]{margin:8px 0}",""]),t.exports=r},468:function(t,e,n){"use strict";n(463)},469:function(t,e,n){var r=n(7)(!1);r.push([t.i,".nav[data-v-4615cf69]{width:100%;position:fixed;bottom:0;z-index:-1}",""]),t.exports=r},472:function(t,e,n){"use strict";n.r(e);n(10),n(21),n(49);var r={name:"QPagination",model:{prop:"value",event:"change"},props:{value:{type:Number,default:0},length:{type:Number,default:0},fmt:{type:String,default:""}},data:function(){return{page:this.value,total:this.length}},watch:{page:function(t){this.$emit("change",t)}},created:function(){},mounted:function(){},methods:{input:function(p){this.$router.push(this.fmt.replace(":p",p))}}},o=(n(468),n(22)),c=n(38),l=n.n(c),d=n(487),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.total>1?n("div",[n("v-pagination",{attrs:{length:t.total},on:{input:t.input},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}),t._v(" "),n("nav",{staticClass:"nav"},[n("ul",t._l(t.total,(function(i){return n("li",{key:i},[t.page==i?n("span",[t._v(t._s(i))]):n("nuxt-link",{attrs:{to:t.fmt.replace(":p",i)}},[t._v(t._s(i))])],1)})),0)])],1):t._e()}),[],!1,null,"4615cf69",null);e.default=component.exports;l()(component,{VPagination:d.a})},584:function(t,e,n){"use strict";n.r(e);n(82),n(57),n(48);var r=n(472),o=n(462),c={components:{QPagination:r.default,FloatButtonGroup:o.default},validate:function(t){var e=t.params;return null==e.p||/^\d+$/.test(e.p)},asyncData:function(t){var e=t.params,n=t.$axios,r=t.error,p=parseInt(e.p||1);return n.post("/getMessage",{limit:50,offset:50*(p-1)}).then((function(data){return data.page=p,data})).catch((function(t){if(console.log(t),200===t.response.status){var data=t.response.data;if(9===data.code||10===data.code)return{page:p,dialog:!0}}r({statusCode:500,message:"An error occurred in the application and your page could not be served. If you are the application owner, check your logs for details."})}))},data:function(){var t=this;return{msg:"",msgMaxLength:500,rules:[function(e){return e.length<=t.msgMaxLength||"最大字数不能超过 ".concat(t.msgMaxLength)}],messages:[],fmt:"/message/:p",errMsg:void 0,snackbar:!1,status:"",text:"",timeout:3e3,count:0,dialog:!1}},computed:{total:function(){return Math.ceil(this.count/50)}},created:function(){},mounted:function(){},methods:{sendMessage:function(){var t=this;this.msg&&this.msg.trim()&&this.$axios.post("/sendMessage",{fromContent:this.msg}).then((function(e){t.text="成功",t.status="success",t.snackbar=!0;var p=Math.ceil((t.count+1)/50);p===t.page?t.messages.push({fromContent:t.msg,fromTime:"刚刚",fromUserName:t.$store.name}):t.$router.push("/message/".concat(p)),t.msg=""})).catch((function(e){t.text=e.response.data.resMsg||"发送留言失败，请重试",t.status="error",t.snackbar=!0,console.log(e)}))},onTextareaChange:function(t){t.length>this.msgMaxLength&&(this.msg=t.slice(0,this.msgMaxLength))}}},l=n(22),d=n(38),v=n.n(d),f=n(456),h=n(187),m=n(56),_=n(460),x=n(453),k=n(184),y=n(499),S=n(455),C=n(561),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("\n      留言板\n    ")]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-text",t._l(t.messages,(function(e,i){return n("v-card",{key:i,staticClass:"ma-2"},[n("v-card-title",[t._v(t._s(e.fromUserName))]),t._v(" "),n("v-card-text",{staticClass:"pl-5"},[t._v(t._s(e.fromContent))]),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("span",{staticClass:"mr-5"},[t._v("\n            "+t._s(e.fromTime)+"\n          ")])],1)],1)})),1),t._v(" "),n("v-divider"),t._v(" "),n("div",{staticClass:"text-center pagination"},[n("q-pagination",{attrs:{length:t.total,fmt:t.fmt},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1),t._v(" "),n("v-divider"),t._v(" "),n("v-card",{attrs:{id:"comment",flat:""}},[n("v-snackbar",{attrs:{timeout:t.timeout,color:t.status,absolute:"",elevation:"24",rounded:"",centered:""},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n        "+t._s(t.text)+"\n      ")]),t._v(" "),n("v-card-title",{staticClass:"headline"},[t._v("\n        发布留言\n      ")]),t._v(" "),n("v-card-subtitle",{staticClass:"mt-2"},[n("v-textarea",{attrs:{solo:"",outlined:"","auto-grow":"",rules:t.rules,counter:t.msgMaxLength,label:"我也说两句"},on:{change:t.onTextareaChange},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}}),t._v(" "),n("div",{staticClass:"d-flex justify-end"},[n("v-btn",{staticClass:"mr-0",attrs:{color:"primary","x-large":""},on:{click:t.sendMessage}},[t._v("留言")])],1)],1)],1)],1),t._v(" "),n("float-button-group",{attrs:{search:""},scopedSlots:t._u([{key:"append",fn:function(){return[n("div",[n("v-btn",{attrs:{fab:"",dark:"",large:"",color:"success"},on:{click:function(e){return t.$vuetify.goTo("#comment",{duration:300})}}},[n("v-icon",{attrs:{dark:""}},[t._v("\n            mdi-comment-processing\n          ")])],1)],1)]},proxy:!0}])}),t._v(" "),n("v-dialog",{attrs:{persistent:"","overlay-opacity":"0.95",width:"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("\n        登录提示\n      ")]),t._v(" "),n("v-card-text",[t._v("\n        留言板需要登录才能使用，当前未登录或登录超时，是否去登录？\n      ")]),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"primary",to:"/login?redirect=/message"}},[t._v("\n          去登录\n        ")]),t._v(" "),n("v-btn",{attrs:{color:"secondary",to:"/"}},[t._v("\n          回首页\n        ")])],1)],1)],1)],1)}),[],!1,null,"61cb9dad",null);e.default=component.exports;v()(component,{FloatButtonGroup:n(462).default}),v()(component,{VBtn:f.a,VCard:h.a,VCardActions:m.a,VCardSubtitle:m.b,VCardText:m.c,VCardTitle:m.d,VDialog:_.a,VDivider:x.a,VIcon:k.a,VSnackbar:y.a,VSpacer:S.a,VTextarea:C.a})}}]);